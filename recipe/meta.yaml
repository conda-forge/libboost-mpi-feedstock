{% set version = "1.83.0" %}

package:
  name: libboost-mpi
  version: {{ version }}

source:
  url: https://boostorg.jfrog.io/artifactory/main/release/{{ version }}/source/boost_{{ version|replace(".", "_") }}.tar.bz2
  sha256: 6478edfe2f3305127cffe8caf73ea0176c53769f4bf1585be237eb30798c3b8e
  patches:
    - 5eff1ecc8413b0dc93a1ab047d7fed751e6cb40e.patch  # [not win]
    - 20841ea1664777c45ab5c8e1ef42113e4e38cb7d.patch  # [win]

build:
  number: 0

requirements:
  build:
    - {{ compiler('cxx') }}

  host:
    - libboost-devel {{ version }}.*
    - {{ mpi }}

  run:
    # explicitly depend on -devel version because we need the headers
    - libboost-devel {{ version }}.*
    - {{ mpi }}

  run_constrained:
    - libboost {{ version }}.*

test:
  commands:
    # Verify library
    - test ! -f $PREFIX/lib/libboost_mpi.a                                               # [unix]
    - test -f $PREFIX/lib/libboost_mpi.dylib                                             # [osx]
    - test -f $PREFIX/lib/libboost_mpi.so                                                # [linux]
    - if not exist %PREFIX%\\Library\\bin\\boost_mpi.dll exit 1                          # [win]
    - if not exist %PREFIX%\\Library\\lib\\boost_mpi.lib exit 1                          # [win]
    - if exist %PREFIX%\\Library\\lib\\libboost_mpi.lib exit 1                           # [win]

about:
  home: http://www.boost.org/
  license: BSL-1.0
  license_file: LICENSE_1_0.txt
  summary: Free peer-reviewed portable C++ source libraries.

extra:
  recipe-maintainers:
    - sdebionne
